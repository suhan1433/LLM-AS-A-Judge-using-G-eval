# LLM-AS-A-Judge-using-G-eval
LLM-AS-A-Judge using G-eval


## 사용법
1. requirements 설치
   ```
   pip install -r requirements.txt
   ```
2. FastAPI 접속
   ```
   uvicorn retrieve_api:app --reload
   ```
   
3. Swagger 접속
   ```
   주소/docs 
   ```
   
4. Data Format:
   ```Python
   [ {"query": str, "answer": str, "chunks": List[str]}, ...]
   ```
   
5. Swagger 파라미터 수정
   - ```Input_path```  : LLM 평가에 사용할 입력 JSON 파일 경로
   - ```output_path``` : LLM 평가 결과를 저장할 JSON 파일 경로
   - ```llm_model```   : 사용할 OpenAI LLM 모델명 (예: 'gpt-4o-mini')
   - ```limit_candidate_idx``` : 각 질문별로 평가할 후보 청크의 최대 개수 (상위 N개만 평가)
   - ```categorical_criteria``` : 범주형 평가지표의 인덱스이며, 리스트는 1부터 시작 (예: [1]), 범주형은 점수 합산 때 포함 안함, 만약 없는 경우 '[]' 입력
   - ```openai_api_key``` : OpenAI API 키 (입력하지 않으면 환경변수 OPENAI_API_KEY 사용)
   - ```system_prompt``` : SystemPrompt내용이며, Swagger보다 py에서 수정하는걸 권장
<img width="1442" height="512" alt="스크린샷 2025-08-11 오후 10 44 44" src="https://github.com/user-attachments/assets/4d0447a9-f0e2-4d9f-8fbf-f723d4050d29" />


6. 각 파라미터 설명 맨 아래 스키마에서 확인 가능
<img width="729" height="511" alt="스크린샷 2025-08-11 오후 10 44 57" src="https://github.com/user-attachments/assets/5a6d80df-f696-4fba-a271-f927f1fa14d0" />

## 입출력 결과

### 입력
```
{
    "query": "웹사이트 관리자 콘솔에 로그인하려면 어떻게 해야 하나요?",
    "answer": "웹사이트 관리자 포털 로그인 페이지에서 [사용자명], [비밀번호]를 입력 후 [로그인] 버튼을 클릭합니다.  \n로그인 성공 시 '관리자 대시보드' 화면으로 이동합니다.  \n경로: [관리자 대시보드] > [로그인]",
    "chunks": [
      "웹사이트 관리자 콘솔을 사용하기 위해서는 관리자 포털 화면에서 로그인을 해야 합니다.\n- 관리자 포털 로그인 페이지 접속 후 [사용자명, 비밀번호] 입력 후 [로그인] 버튼 클릭\n\n  관리자 콘솔의 로그인 화면. 사용자명과 비밀번호 입력 필드, 그리고 로그인 버튼이 표시되어 있습니다.\n\n- 로그인 성공 시 관리자 대시보드 화면으로 이동\n\n  관리자 대시보드 화면. 사이트 통계 그래프, 일일 사용자 트래픽, 콘텐츠 현황 목록, 시스템 알림, 관리 작업 목록이 표시되어 있습니다.",
      "콘텐츠 유형을 먼저 선택해야 합니다. 저장소 체크박스: [하단 좌측] - 배포에 사용할 콘텐츠 저장소를 선택합니다. 저장소 라벨: [하단 중앙] - 선택된 콘텐츠 저장소의 이름을 표시합니다. 표시된 데이터/텍스트는 다음과 같습니다. 배포 워크플로우:[표준] 배포 워크플로우 선택 드롭다운의 기본 값으로 선택되어 있습니다.워크플로우 목록으로는 \"콘텐츠검토-승인-스테이징배포-품질검사\", \"표준_배포\", \"검토, 예약배포\", 그리고 \"검토 요청 예약\"이 배포 워크플로우 선택 드롭다운 메뉴에 표시된 워크플로우 이름입니다. * 즉시 : 기존 실행하고 있던 표준 워크플로우를 강제 중단 후 즉시 사용되는 워크플로우 배포 워크플로우 설정 화면. 콘텐츠 배포 작업을 위한 워크플로우를 정의하고 설정하는 화면입니다. 배포 워크플로우 유형을 선택하고, 담당자를 지정하며, 콘텐츠 저장소 및 버전을 선택하여 배포 프로세스를 구성합니다. 주요 화면 요소는 다음과 같습니다."
    ]
  },
```

### 결과
| **필드명**             | **타입**      | **설명**                    | **예시 (값)**                                                                                                                        |
| ------------------- | ----------- | ------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| category            | str         | 평가 기준 제목                  | GOLDEN CONTENT COVERAGE                                                                                                           |
| score               | float       | 평가 결과 점수(1-5점 사이)         | 4.47                                                                                                                              |
| reason              | str         | 평가 결과                     | 청크는 골든 답안의 주요 단계인 로그인 과정과 성공 후 이동하는 화면에 대한 정보를 대부분 포함하고 있지만, '로그인 페이지'에 대한 구체적인 설명이 부족하여 일부 세부사항이 누락되었습니다.                        |
| score\_prob\_result | List\[dict] | 각 평가 점수 확률 분포             | \ "3": 0.96,
          "4": 0.02,
          "2": 0.02,
          "1": 0.0,
          "5": 0.0 |
| total\_score        | float       | 모든 평가 점수 확률분포를 고려해 합산한 점수 | 4.23                                                                                                                              |


